<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2P Fighting Game</title>
  <style>
    body { margin: 0; overflow: hidden; background: #222; }
    canvas { display: block; margin: auto; background: #333; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="400"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

class Fighter {
  constructor(x, color, controls) {
    this.x = x;
    this.y = 300;
    this.vx = 0;
    this.vy = 0;
    this.width = 40;
    this.height = 80;
    this.color = color;
    this.controls = controls;
    this.onGround = true;
    this.hp = 100;
  }

  draw() {
    ctx.fillStyle = this.color;
    ctx.fillRect(this.x, this.y - this.height, this.width, this.height);
    ctx.fillStyle = "red";
    ctx.fillRect(this.x, this.y - this.height - 10, this.width * (this.hp / 100), 5);
  }

  update() {
    this.x += this.vx;
    this.y += this.vy;
    if (this.y < 300) {
      this.vy += 0.8; // gravity
      this.onGround = false;
    } else {
      this.vy = 0;
      this.y = 300;
      this.onGround = true;
    }
    this.x = Math.max(0, Math.min(canvas.width - this.width, this.x));
  }

  attack(opponent) {
    if (Math.abs(this.x - opponent.x) < 50 && Math.abs(this.y - opponent.y) < 40) {
      opponent.hp = Math.max(0, opponent.hp - 10);
    }
  }
}

const keys = {};
const p1 = new Fighter(100, "blue", {
  left: "a", right: "d", up: "w", down: "s", attack1: "z", attack2: "x"
});
const p2 = new Fighter(600, "green", {
  left: "ArrowLeft", right: "ArrowRight", up: "ArrowUp", down: "ArrowDown", attack1: "Control", attack2: "Alt"
});

window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

function handleInput(player) {
  player.vx = 0;
  if (keys[player.controls.left]) player.vx = -5;
  if (keys[player.controls.right]) player.vx = 5;
  if (keys[player.controls.up] && player.onGround) player.vy = -12;
  if (keys[player.controls.attack1]) player.attack(player === p1 ? p2 : p1);
  if (keys[player.controls.attack2]) player.attack(player === p1 ? p2 : p1);
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  handleInput(p1);
  handleInput(p2);

  p1.update();
  p2.update();

  p1.draw();
  p2.draw();

  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
